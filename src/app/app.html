<body class="bg-light">
<div class="bg-dark text-light text-center py-3">
  <h1 class="mb-0">OPTICA TÚ</h1>
  <small>Solicita información de nuestros productos</small>
</div>

<div class="container py-4">
  <div class="card mx-auto col-12 col-md-10 col-lg-8 shadow-sm p-4">
    <form id="solicitudForm" [formGroup]="optica" (ngSubmit)="onsubmit()" novalidate>
      <div class="mb-3">
        <label for="nombre" class="form-label">Nombre:  <span class="text-danger">*</span></label>
        <input type="text" formControlName="nombre" maxlength="100" class="form-control" id="nombre"
               [class.is-invalid]="formSubmitted && optica.get('nombre')?.invalid"
               placeholder="Introduce tu nombre" required>
        <div class="invalid-feedback" *ngIf="formSubmitted && optica.get('nombre')?.invalid">
          {{ getErrorMessage('nombre', optica.get('nombre')!) }}
        </div>
      </div>

      <div class="mb-3">
        <label for="email" class="form-label">Email: <span class="text-danger">*</span></label>
        <input type="email" formControlName="email" maxlength="100" class="form-control" id="email"
               [class.is-invalid]="formSubmitted && optica.get('email')?.invalid"
               placeholder="ejemplo@dominio.com" required>
        <div class="invalid-feedback" *ngIf="formSubmitted && optica.get('email')?.invalid">
          {{ getErrorMessage('email', optica.get('email')!) }}
        </div>
      </div>

      <div class="mb-3">
        <label for="telefono" class="form-label">Tfno: </label>
        <input type="tel" formControlName="telefono" class="form-control" id="telefono"
               [class.is-invalid]="formSubmitted && optica.get('telefono')?.invalid"
               placeholder="Empieza por 6, 7 o 9 (opcional)">
        <div class="invalid-feedback" *ngIf="formSubmitted && optica.get('telefono')?.invalid">
          {{ getErrorMessage('telefono', optica.get('telefono')!) }}
        </div>
      </div>

      <div class="row g-3 mb-3">
        <div class="col-12 col-md-4">
          <label for="cp" class="form-label">CP: <span class="text-danger">*</span></label>
          <input type="text" formControlName="cp" class="form-control" id="cp" maxlength="5"
                 [class.is-invalid]="formSubmitted && optica.get('cp')?.invalid"
                 placeholder="00000" required>
          <div class="invalid-feedback" *ngIf="formSubmitted && optica.get('cp')?.invalid">
            {{ getErrorMessage('cp', optica.get('cp')!) }}
          </div>
        </div>
        <div class="col-12 col-md-8">
          <label for="provincia" class="form-label">Provincia: </label>
          <input type="text" formControlName="provincia" class="form-control" id="provincia"
                 readonly placeholder="Provincia calculada" aria-readonly="true">
        </div>
      </div>

      <div class="mb-3">
        <label class="form-label d-block">Tipo:  <span class="text-danger">*</span></label>
        <div class="btn-group" role="group" aria-label="Tipo">
          <input type="radio" formControlName="tipo" class="btn-check" id="gafas" value="Gafas" autocomplete="off">
          <label class="btn btn-outline-secondary" for="gafas">Gafas</label>

          <input type="radio" formControlName="tipo" class="btn-check" id="lentillas" value="Lentes de contacto" autocomplete="off">
          <label class="btn btn-outline-secondary" for="lentillas">Lentes de contacto</label>
        </div>
        <div class="form-text">Elija una opción</div>
        <div class="invalid-feedback d-block" *ngIf="formSubmitted && optica.get('tipo')?.invalid">
          {{ getErrorMessage('tipo', optica.get('tipo')!) }}
        </div>
      </div>

      <div class="mb-3">
        <label for="dolencias" class="form-label">Dolencias: </label>
        <select class="form-select" formControlName="dolencias" id="dolencias" multiple aria-label="Dolencias">
          <option value="Miopia">Miopía</option>
          <option value="Astigmatismo">Astigmatismo</option>
          <option value="Ojos cansados">Ojos cansados</option>
          <option value="Hipermetropia">Hipermetropía</option>
        </select>
        <div class="form-text">Selección múltiple abierta</div>
      </div>

      <div class="mb-3">
        <label for="fecha" class="form-label">Fecha deseada:  <span class="text-danger">*</span></label>
        <input type="text" formControlName="fecha" class="form-control" id="fecha"
               [class.is-invalid]="formSubmitted && optica.get('fecha')?.invalid"
               placeholder="dd/mm/aaaa" required>
        <div class="invalid-feedback" *ngIf="formSubmitted && optica.get('fecha')?.invalid">
          {{ getErrorMessage('fecha', optica.get('fecha')!) }}
        </div>
      </div>

      <div class="mb-3">
        <label for="comentarios" class="form-label">Comentarios:</label>
        <textarea class="form-control" formControlName="comentario" id="comentarios" rows="4" maxlength="250"
                  placeholder="Máx. 250 caracteres"></textarea>
      </div>

      <div class="mb-3 form-check">
        <input class="form-check-input" formControlName="checkbox" type="checkbox" id="aceptar"
               [class.is-invalid]="formSubmitted && optica.get('checkbox')?.invalid">
        <label class="form-check-label" for="aceptar">
          Aceptar condiciones <span class="text-danger">*</span>
        </label>
        <div class="invalid-feedback" *ngIf="formSubmitted && optica.get('checkbox')?.invalid">
          {{ getErrorMessage('checkbox', optica.get('checkbox')!) }}
        </div>
      </div>

      <div class="d-flex justify-content-end">
        <button type="submit" id="submit" class="btn btn-primary">ENVIAR</button>
      </div>
    </form>
  </div>
</div>

<div class="modal fade" id="errorsModal" tabindex="-1" aria-labelledby="errorsModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-danger text-white">
        <h5 id="errorsModalLabel" class="modal-title">Errores en el formulario</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body" id="modalErrorsList"></div>
      <div class="modal-footer">
        <button class="btn btn-secondary" data-bs-dismiss="modal">Corregir</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="dataModal" tabindex="-1" aria-labelledby="dataModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header bg-success text-white">
        <h5 id="dataModalLabel" class="modal-title">Datos enviados correctamente</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      <div class="modal-body" id="modalDataBody"></div>
      <div class="modal-footer">
        <button class="btn btn-primary" data-bs-dismiss="modal">Aceptar</button>
      </div>
    </div>
  </div>
</div>

</body>
<router-outlet />
